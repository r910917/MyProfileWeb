<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>ğŸŒ èŠ±è“®å…‰å¾©æ•‘ç½äº¤é€šåª’åˆ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<style>
/* ==========================================================================
   å…¨ç«™åŸºç¤ï¼šå­—é«”ã€èƒŒæ™¯ã€ä¸»æ¨™é¡Œ/å°æ¨™é¡Œ
   ========================================================================== */
body{
  font-family:"Microsoft JhengHei",sans-serif;
  margin:0; padding:0;
  background:linear-gradient(to right,#eaf8ff,#f7fff7);
  color:#222;
}
h1{ text-align:center; padding:20px; color:#005c4b; }
h2{ color:#00695c; margin:20px; font-size:20px; }

/* ==========================================================================
   é¦–é å…©é¡†ä¸»åŠŸèƒ½æŒ‰éˆ•
   ========================================================================== */
.buttons{ text-align:center; margin:20px 0; }
.btn-main{
  display:inline-flex; align-items:center; gap:6px;
  padding:12px 24px; font-size:16px; border-radius:8px;
  border:none; cursor:pointer; margin:0 6px; color:#fff; font-weight:bold;
  transition:transform .2s, background .3s;
}
.btn-driver{ background:#007bff; }
.btn-driver:hover{ background:#0056b3; transform:scale(1.05); }
.btn-passenger{ background:#dc3545; }
.btn-passenger:hover{ background:#a71d2a; transform:scale(1.05); }

/* ==========================================================================
   å¡ç‰‡ï¼ˆDriver/Passenger åˆ—è¡¨ï¼‰ï¼‹ å·¦å´è‰²æ¢
   ========================================================================== */
/* æ›´è²¼å·¦ã€è¼ƒè–„çš„å¡ç‰‡ */
.card{
  display:flex;
  align-items:left;
  justify-content:space-between;
  background:#fff;
  margin:3px;                 /* å–æ¶ˆå¥‡æ€ªçš„è² é‚Šè·ï¼Œå·¦å³ä¸ç¸®é€² */
  padding:8px 12px 8px 24px;    /* ä¸Šä¸‹è®Šè–„ã€å·¦é‚Šå¤šä¸€é»ç©ºé–“çµ¦è‰²æ¢ */
  border-radius:8px;            /* æ¯” 1px å¥½çœ‹è¨±å¤š */
  box-shadow:0 2px 6px rgba(0,0,0,.08);
  position:relative;
  flex-wrap:wrap;
  animation:fadeInUp .3s ease-out;
}

/* è®“è‰²æ¢å¾®å¾®çªå‡ºåˆ°å¡ç‰‡å¤–ï¼Œè¦–è¦ºä¸Šæ›´é å·¦ï¼Œä½†ä¸éœ€è¦è² é‚Šè· */
.card::before{
  content:"";
  position:absolute;
  top:0;
  bottom:0;       /* ç­‰åŒæ–¼ height:100% + æ›´ç©©å®š */
  left:10px;      /* å‘å·¦çªå‡º 8pxï¼Œé”åˆ°ã€Œè²¼å·¦ã€æ•ˆæœ */
  width:6px;
  border-radius:6px 0 0 6px;
}

.driver-card::before{ background:#2196f3; }
.passenger-card::before{ background:#f44336; }

/* 1) å–æ¶ˆ UL é è¨­ç¸®æ’ï¼šå¡ç‰‡ä¸è¦è¢«æ¨åˆ°å³å´ */
#driver-list,
#passenger-list {
  list-style: none;
  margin: 0;
  padding: 0;        /* â† é€™è¡Œæ˜¯é‡é» */
}

/* å¦‚æœæœ‰å…¶å®ƒå®¹å™¨å° ul/li åšäº† padding-leftï¼Œä¹Ÿä¸€ä½µæ­¸é›¶ */
#driver-list > li,
#passenger-list > li {
  margin-left: 0;
}

/* ==========================================================================
   å¸æ©Ÿå¡ç‰‡ä¸‰æ¬„æ’ç‰ˆï¼ˆå·¦ï¼šæš±ç¨±åº§ä½ / ä¸­ï¼šä¸‰è¡Œ / å³ï¼šæ“ä½œèˆ‡ç®­é ­ï¼‰
   ========================================================================== */
.driver-grid{
  display:grid; grid-template-columns:minmax(140px,200px) 1fr auto;
  column-gap:10px; align-items:center; width:100%;
}
/* å·¦æ¬„ï¼šæš±ç¨± - åº§ä½ */
.col-left{ display:flex; align-items:center; justify-content:flex-start; height:100%; font-size:15px; }
.name-seat{ font-size:15px; color:#222; margin:0; }
/* ä¸­æ¬„ï¼šä¸‰è¡Œè³‡è¨Š */
.col-middle .line{ display:block; margin:2px 0; }
.col-middle .line1{ font-size:16px; color:#222; }
.col-middle .line2, .col-middle .line3{ font-size:14px; color:#444; }
/* å³æ¬„ï¼šæ“ä½œæŒ‰éˆ•ï¼‹ç®­é ­ */
.col-actions{ display:flex; align-items:center; justify-content:flex-end; gap:6px; }

/* å±•é–‹å€å¡Šé‹ªæ»¿æ•´åˆ— */
.details{ grid-column:1 / -1; }

/* ==========================================================================
   å±•é–‹/æ”¶åˆï¼šç®­é ­æ—‹è½‰ã€çµ²æ»‘é–‹åˆï¼›ç®¡ç†/åƒåŠ æŒ‰éˆ•è‰²ç³»
   ========================================================================== */
.arrow{
  cursor:pointer; margin-left:6px; min-width:36px; min-height:36px;
  font-size:16px; color:#333; background:transparent; border:0;
  transition:transform .25s ease;
}
.arrow.open{ transform:rotate(90deg); }

.details{
  margin-top:0px; max-height:0; overflow:hidden; padding:0px 0px;
  background: transparent; border:0 #e6e6e6;
  transition:max-height 1.2s ease, padding 1s ease;
}
/* å±•é–‹æ™‚å†åŠ å›å¤–è§€ */
.details.open {
  margin-top: 8px;
  max-height: 650px;
  padding: 10px;
  background: #f9f9f9;
  border-top: 1px solid #e6e6e6;
  border-radius: 6px;
}

.btn-manage{ background:#007bff; color:#fff; border:0; border-radius:6px; padding:6px 10px; }
.btn-manage:hover{ background:#0056b3; }
.btn-join{ background:#28a745; color:#fff; border:0; border-radius:6px; padding:6px 10px; }
.btn-join:hover{ background:#1e7e34; }

/* =============================================================================
   A. ä¹˜å®¢æ¸…å–®ï¼ˆå¾…ç¢ºèª / å·²æ¥å—ï¼‰å¡ç‰‡æ¨£å¼
   ========================================================================== */

/* æ¸…å–®å®¹å™¨ï¼ˆèˆŠ two-col ä¿ç•™ï¼ŒæŸäº›é é¢å¯èƒ½ä»åœ¨ç”¨ï¼‰ */
.pax-section{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:16px;
  align-items:start;
}
@media (max-width: 860px){
  .pax-section{ grid-template-columns: 1fr; }
}

.pax-list{ list-style:none; padding:0; margin:8px 0 0; }
.pax-item{
  box-sizing:border-box;
  background:#fff;
  border:1px solid #e5e7eb;
  border-radius:10px;
  padding:12px 14px;
  margin:8px 0;
}

/* æ¯ç­†ï¼šå·¦æ–‡å­—ï¼ˆå…©è¡Œï¼‰ + å³æŒ‰éˆ• */
.pax-2col{
  display:grid;
  grid-template-columns: 1fr auto;
  column-gap: 12px;
  align-items:center;
}
.pax-left{ min-width:0; }
.pax-title{
  font-weight:700;
  font-size:15px;
  color:#111827;
  line-height:1.25;
}
.pax-sub{
  margin-top:2px;
  font-size:13px;
  color:#4b5563;
  line-height:1.3;
}
.pax-actions{ display:inline-flex; gap:8px; white-space:nowrap; }

.btn-mini{
  border:0; border-radius:8px; padding:6px 10px; background:#e5e7eb; cursor:pointer;
}
.btn-mini:hover{ background:#d1d5db; }
.btn-mini.danger{ background:#fecaca; color:#7f1d1d; }
.btn-mini.danger:hover{ background:#fca5a5; }

/* å·²æ¥å—ï¼šç¶ è‰²åº•æç¤º */
.pax-item.pax-accepted{ background:#f0fdf4; border:1px solid #bbf7d0; }
.pax-item.pax-accepted .pax-title .check{
  display:inline-block; margin-right:6px; color:#16a34a; font-weight:800;
}
.pax-item.pax-accepted .btn-mini{ background:#e7f5ec; }
.pax-item.pax-accepted .btn-mini:hover{ background:#d9f0e4; }

/* æ‰‹æ©ŸæŒ‰éˆ•è½åˆ°ä¸‹æ–¹ */
@media (max-width: 640px){
  .pax-2col{ grid-template-columns:1fr; row-gap:8px; align-items:start; }
  .pax-actions{ justify-content:flex-start; }
}

/* è‡ªè¨‚å·è»¸ï¼ˆæ·¡æ·¡çš„ï¼‰ */
.pax-scroll::-webkit-scrollbar,
.pending-scroll::-webkit-scrollbar{ width:8px; }
.pax-scroll::-webkit-scrollbar-thumb,
.pending-scroll::-webkit-scrollbar-thumb{ background:#d5d9e0; border-radius:6px; }
.pax-scroll::-webkit-scrollbar-track,
.pending-scroll::-webkit-scrollbar-track{ background:transparent; }


/* =============================================================================
   B. è©³ç´°å€å¡Šï¼šä¸‰æ¬„ï¼ˆæ¡Œæ©Ÿï¼‰= å·¦ï¼šå¸æ©Ÿè³‡è¨Š / ä¸­ï¼šå¾…ç¢ºèª / å³ï¼šå·²æ¥å—
   ========================================================================== */

/* ä½ çš„ details é–‹é—”å‹•ç•«ï¼ˆä¿ç•™ï¼‰ */
.details{
  margin-top:8px; max-height:0; overflow:hidden; padding:8px 10px;
  background:#f9f9f9; border-top:1px solid #e6e6e6; border-radius:6px;
  transition:max-height .35s ease, padding .25s ease;
}
.details.open{ max-height:1200px; padding:10px; }

/* ä¸‰æ¬„å®¹å™¨ï¼ˆæ¡Œæ©Ÿï¼‰ */
.details-grid3{
  /* å¯èª¿é«˜åº¦ï¼šä¸‰æ¬„åŒé«˜ï¼Œå…§å®¹è¶…å‡ºå‰‡å„è‡ªå‡ºç¾å·è»¸ */
  --panel-h: 340px;

  display:grid;
  grid-template-columns: minmax(420px, 2fr) minmax(320px, 1fr) minmax(320px, 1fr);
  gap:16px;
  align-items:stretch;  /* ä¸‰æ¬„æ‹‰é½Š */
}

/* æ¬„ä½å…§ç›’ï¼šçµ¦ä¸‰æ¬„çµ±ä¸€é«˜åº¦èˆ‡å·è»¸ç”¨ */
.details-col{
  height: var(--panel-h);
  min-height: 0;          /* é‡è¦ï¼šè®“ grid å…§å…ƒç´ å¯ä»¥æ­£ç¢º overflow */
  background:#fff;
  border:1px solid #e5e7eb;
  border-radius:10px;
  overflow:auto;
  padding:14px 16px;
  box-shadow: 0 1px 2px rgba(0,0,0,.03);
}

/* ä¸­ã€å³æ¬„æ¨™é¡Œ */
.pax-panel-title{
  margin:0 0 10px;
  font-weight:800;
  font-size:15px;
  color:#0f172a;
  display:flex; align-items:center; gap:6px;
}

/* ä¸­ã€å³æ¬„åˆ—è¡¨å®¹å™¨ï¼ˆç­‰é«˜å·è»¸ï¼‰ */
.pax-scroll{
  height: calc(var(--panel-h) - 38px); /* æ‰£æ‰æ¨™é¡Œå€é«˜åº¦(ç´„) */
  overflow:auto;
  padding-right:6px;
}

/* RWDï¼šâ‰¤980px å›å–®æ¬„ï¼Œä¸è¦å›ºå®šé«˜åº¦èˆ‡å·è»¸ */
@media (max-width: 980px){
  .details-grid3{ grid-template-columns:1fr; }
  .details-col{ height:auto; overflow:visible; }
  .pax-scroll{ height:auto; overflow:visible; padding-right:0; }
}


/* =============================================================================
   C. å¸æ©Ÿè³‡è¨Šï¼ˆå·¦æ¬„ï¼‰æ’ç‰ˆå„ªåŒ–
   ========================================================================== */

/* å·¦æ¬„å…§çš„è¦–è¦ºï¼šæ¨™é¡Œåˆ— */
.driver-info__title{
  display:flex; align-items:center; gap:8px;
  font-weight:800; color:#0f172a;
  margin:2px 0 12px;
}
.driver-info__title .emoji{ font-size:18px; }

/* key-value ç‰ˆé¢ï¼šæ•´é½Šå°é½Šæˆå…©æ¬„ï¼ˆæ¨™ç±¤ / å…§å®¹ï¼‰ */
.driver-kv{
  display:grid;
  grid-template-columns: 92px 1fr;
  row-gap:8px;
  column-gap:10px;
}
.driver-kv .k{
  color:#475569;
  font-weight:600;
  text-align:right;
}
.driver-kv .v{
  color:#111827;
  word-break:break-word;
}

/* å°åˆ†éš”ç·šç¾¤çµ„ï¼šè®“è³‡è¨Šå€å¡Šæ›´ä¹¾æ·¨ */
.driver-info__group{
  display:grid; gap:8px;
  padding-bottom:8px;
  border-bottom:1px dashed #e5e7eb;
  margin-bottom:10px;
}
.driver-info__group:last-child{ border-bottom:0; padding-bottom:0; margin-bottom:0; }

/* æ¬¡è¦æ–‡å­—ï¼ˆä¾‹å¦‚ã€Œæœªæä¾›ã€ã€ã€Œæœªå®šã€ï¼‰ */
.text-muted{ color:#6b7280; }

/* RWDï¼šæ‰‹æ©Ÿæ™‚æ”¹æˆå–®æ¬„ */
@media (max-width: 640px){
  .driver-kv{ grid-template-columns: 86px 1fr; }
}


/* =============================================================================
   D. ä½ ç¾æœ‰çš„ç®­é ­/å¡ç‰‡/æŒ‰éˆ•ï¼ˆå¦‚éœ€ï¼Œä¿ç•™ï¼‰
   ========================================================================== */

.arrow{ cursor:pointer; margin-left:6px; min-width:36px; min-height:36px;
  font-size:16px; color:#333; background:transparent; border:0;
  transition: transform .25s ease;
}
.arrow.open{ transform: rotate(90deg); }

.btn-manage{ background:#007bff; color:#fff; border:0; border-radius:6px; padding:6px 10px; }
.btn-manage:hover{ background:#0056b3; }
.btn-join{ background:#28a745; color:#fff; border:0; border-radius:6px; padding:6px 10px; }
.btn-join:hover{ background:#1e7e34; }

/* ==========================================================================
   Modalï¼šé€šç”¨ï¼ˆé®ç½©/å®¹å™¨/é—œé–‰éˆ•/å€å¡Šï¼‰
   ========================================================================== */
.modal{
  position:fixed; inset:0; z-index:1000; background:rgba(0,0,0,.55);
  display:none;
}
.modal .modal-content{
  display:flex; flex-direction:column;
  width:min(520px,94vw); max-height:min(92svh,640px);
  margin:6svh auto; background:#fff; border-radius:12px;
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}
.modal-header, .modal-footer{
  flex:0 0 auto; padding:14px 16px; border-bottom:1px solid #eee;
}
.modal-footer{ border-top:1px solid #eee; border-bottom:0; display:flex; justify-content:flex-end; gap:8px; }
.modal-body{ flex:1 1 auto; overflow-y:auto; padding:14px 16px; }
.close{ background:transparent; border:0; font-size:20px; cursor:pointer; }
/* èƒŒæ™¯é åœ¨ modal é–‹å•Ÿæ™‚ä¸è¦æ²å‹•ï¼ˆå¯é¸ï¼‰ */
.body-modal-open{ overflow:hidden; }

/* ==========================================================================
   Join Modalï¼šå¤–è§€å¾®èª¿ï¼ˆé«˜åº¦è¼ƒçŸ®ã€Header/Body/Footer é»è²¼ï¼‰
   ========================================================================== */
#joinModal .modal-content{
  width:min(520px,94vw);
  max-height:min(88svh,620px);
  margin:4svh auto;
  border-radius:14px; overflow:hidden;
  box-shadow:0 14px 34px rgba(0,0,0,.25);
  background:#fff; display:flex; flex-direction:column;
}
/* Headerï¼ˆç½®ä¸­ã€è¼ƒè–„ã€stickyï¼‰ */
#joinModal .modal-header{
  position:sticky; top:0; z-index:2;
  display:flex; align-items:center; justify-content:center;
  min-height:44px; padding:8px 16px; background:#fff; border-bottom:1px solid #eee;
}
#joinModal .modal-header .title{
  font-size:16px; font-weight:700; color:#111827;
  display:inline-flex; align-items:center; gap:8px;
}
#joinModal .modal-header .title .emoji{ font-size:18px; line-height:1; }
/* å³ä¸Šè§’é—œé–‰ */
#joinModal .modal-header .close{
  position:absolute; right:10px; top:8px;
  width:28px; height:28px; border-radius:6px;
  display:inline-grid; place-items:center;
  font-size:18px; color:#6b7280; background:transparent;
}
#joinModal .modal-header .close:hover{ background:#f3f4f6; color:#111827; }
/* Body æ»¾å‹• */
#joinModal .modal-body{ flex:1 1 auto; overflow-y:auto; padding:12px 16px; }
/* Footer é»åº• */
#joinModal .modal-footer{
  position:sticky; bottom:0; z-index:2;
  display:flex; justify-content:flex-end; gap:8px;
  padding:10px 16px; background:#fff; border-top:1px solid #eee;
}
#joinModal .btn-cancel, #joinModal .btn-submit{
  border-radius:10px; padding:10px 18px; font-weight:700;
}

/* ==========================================================================
   Join Modalï¼šè¡¨å–®æ¬„ä½ï¼ˆä¸Šæ–¹æ¨™ç±¤ã€ä¸‹æ–¹è¼¸å…¥æ¡†ï¼‰
   ========================================================================== */
#joinModal .join-field{
  display:flex; flex-direction:column; gap:6px; margin:12px 0;
}
#joinModal .join-field label{
  display:block; font-weight:600; color:#1f2937; line-height:1.2;
}
#joinModal .join-field input,
#joinModal .join-field select,
#joinModal .join-field textarea{
  width:50%;
  padding:10px 12px; border:1px solid #d1d5db; border-radius:8px;
  background:#fff; font-size:14px; line-height:1.25;
  transition:border-color .2s, box-shadow .2s;
}
#joinModal .join-field input:focus,
#joinModal .join-field select:focus,
#joinModal .join-field textarea:focus{
  outline:none; border-color:#3b82f6;
  box-shadow:0 0 0 3px rgba(59,130,246,.15);
}
/* å‚™è¨»è¼ƒé«˜ */
#joinModal textarea[name="note"]{ min-height:96px; }

/* ==========================================================================
   è¿”å›é ‚ç«¯æŒ‰éˆ•
   ========================================================================== */
#backToTop{
  position:fixed; bottom:20px; right:20px;
  background:#00897b; color:#fff; border:none; border-radius:50%;
  padding:14px; font-size:20px; cursor:pointer;
  box-shadow:0 4px 8px rgba(0,0,0,.2);
  z-index:1200; transition:transform .2s, background .3s;
}
#backToTop:hover{ background:#00695c; transform:scale(1.08); }

/* ==========================================================================
   å‹•ç•«
   ========================================================================== */
@keyframes fadeInUp{
  from{ opacity:0; transform:translateY(15px); }
  to{ opacity:1; transform:translateY(0); }
}

/* ==========================================================================
   RWD æ–·é»èª¿æ•´
   ========================================================================== */
/* â‰¤1024pxï¼šå¡ç‰‡èˆ‡ä¸»æŒ‰éˆ•å¾®èª¿ */
@media (max-width:1024px){
  .card{ padding:8px 12px 8px 24px; margin:3px; }
  .btn-main{ padding:10px 16px; font-size:15px; }
}
/* â‰¤768pxï¼šå­—ç´šã€å°æ¨™é¡Œã€ä¸»æŒ‰éˆ•ç­‰ */
@media (max-width:768px){
  body{ font-size:15px; }
  h1{ font-size:22px; }
  h2{ font-size:18px; margin:14px; }
  .buttons{ padding:0 12px; }
  .btn-main{ width:auto; min-width:44%; }
  #toast-container{ top:env(safe-area-inset-top,16px); right:12px; left:24px; }
}
/* â‰¤640pxï¼šä¸»æŒ‰éˆ•æ»¿ç‰ˆã€å¸æ©Ÿå¡ç‰‡ä¸‰æ¬„æ”¹å–®æ¬„ã€Modal æ›´ç·Šæ¹Šã€Join è¡¨å–®ç¶­æŒç›´å‘ */
@media (max-width:640px){
  /* ä¸»æŒ‰éˆ•æ”¹å–®æ¬„æ»¿ç‰ˆ */
  .buttons{ display:grid; grid-template-columns:1fr; gap:10px; padding:0 12px; }
  .btn-main{ width:100%; }

  /* å¸æ©Ÿå¡ç‰‡ï¼šä¸‰æ¬„â†’å–®æ¬„ */
  .driver-grid{ display:grid; grid-template-columns:1fr; grid-row-gap:8px; }
  .col-left, .col-middle, .col-actions{ width:100%; }
  .col-left .name-seat{ font-size:16px; margin-bottom:6px; text-align:left; }
  .col-middle .line{ display:block; margin:4px 0; font-size:14px; }

  .col-actions{
    display:grid; grid-template-columns:1fr 1fr auto; align-items:center; gap:8px;
  }
  .btn-manage, .btn-join{ width:100%; min-height:44px; font-size:15px; }
  .arrow{ font-size:18px; min-width:44px; min-height:44px; display:inline-grid; place-items:center; }
  .details{
  margin-top:0px; max-height:0; overflow:hidden; padding:0px 0px;
  background: transparent; border:0 #e6e6e6;
  transition:max-height 1.2s ease, padding 1s ease;
  }
  /* å±•é–‹æ™‚å†åŠ å›å¤–è§€ */
  .details.open {
    margin-top: 8px;
    max-height: 1200px;
    padding: 10px;
    background: #f9f9f9;
    border-top: 1px solid #e6e6e6;
    border-radius: 6px;
  }
  .details h4{ font-size:15px; margin:6px 0 4px; }
  .details p, .details li{ font-size:14px; margin:2px 0; }

  /* ä¹˜å®¢å¡ç‰‡ï¼šä¸»åˆ—å–®æ¬„ã€æ“ä½œé å³ */
  .pax-row{ grid-template-columns:1fr; }
  .pax-actions{ justify-content:flex-end; }

  /* é€šç”¨ modal å¯¬åº¦ */
  .modal .modal-content{ width:94vw; margin:4svh auto; }

  /* Join è¡¨å–®æ¬„ä½é–“è·èˆ‡æŒ‰éˆ•é«˜åº¦ */
  #joinModal .join-field{ margin:10px 0; gap:6px; }
  .btn-submit, .btn-cancel{ min-height:44px; font-size:16px; }

  /* JoinModal å†å£“ç¸® header/é‚Šè· */
  #joinModal .modal-content{ max-height:min(92svh,640px); margin:3svh auto; }
  #joinModal .modal-header{ min-height:40px; padding:6px 14px; }
  #joinModal .modal-header .title{ font-size:15px; }
  #joinModal .modal-body{ padding:10px 14px; }
  #joinModal .modal-footer{ padding:8px 14px; }

  /* è¿”å›é ‚ç«¯ä½ç½® */
  #backToTop{ right:12px; bottom:16px; }
}
/* â‰¤400pxï¼šå­—ç´šèª¿æ•´ã€æŒ‰éˆ•èˆ‡ç®­é ­æ›´å° */
@media (max-width:400px){
  body{ font-size:14px; }
  h1{ font-size:20px; }
  h2{ font-size:16px; margin:10px; }
  .col-left .name-seat{ font-size:15px; }
  .col-middle .line1{ font-size:15px; }
  .col-middle .line2, .col-middle .line3{ font-size:13px; }
  .btn-manage, .btn-join{ font-size:14px; padding:8px 10px; }
  .arrow{ font-size:16px; min-width:40px; min-height:40px; }
}
/* ============================================================================
   Pax Edit Modal ç¾åŒ–ï¼ˆåªå½±éŸ¿ #paxEditModalï¼‰
   ========================================================================== */

/* èƒŒæ™¯ï¼šåŠé€æ˜ï¼‹è¼•å¾®æ¨¡ç³Š */
#paxEditModal.modal{
  position: fixed; inset: 0; z-index: 1200;
  background: rgba(15, 23, 42, .45);
  backdrop-filter: blur(2px);
  display: none; /* ç”¨ JS æ§åˆ¶ show/hide */
}

/* å®¹å™¨ï¼šç½®ä¸­ã€åœ“è§’ã€é™°å½±ã€flex ç›´å‘ */
#paxEditModal .modal-content{
  width: min(560px, 94vw);
  max-height: min(88svh, 680px);
  margin: 5svh auto;
  background: #ffffff;
  border-radius: 14px;
  box-shadow: 0 18px 40px rgba(2, 6, 23, .25);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* Header / Footer é»ä½é ‚åº•ï¼Œå…§å®¹å€å¯æ²å‹• */
#paxEditModal .modal-header,
#paxEditModal .modal-footer{
  flex: 0 0 auto;
  padding: 12px 16px;
  background: #fff;
  border-bottom: 1px solid #eef2f7;
}
#paxEditModal .modal-footer{
  border-top: 1px solid #eef2f7;
  border-bottom: 0;
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

/* æ¨™é¡Œèˆ‡é—œé–‰éˆ• */
#paxEditModal .modal-header{
  position: sticky; top: 0; z-index: 2;
  display: flex; align-items: center; justify-content: center;
}
#paxEditModal .modal-header .title{
  font-weight: 800; color: #0f172a; font-size: 16px;
  display: inline-flex; gap: 8px; align-items: center;
}
#paxEditModal .modal-header .close{
  position: absolute; right: 10px; top: 8px;
  width: 32px; height: 32px;
  border: 0; border-radius: 8px;
  display: inline-grid; place-items: center;
  font-size: 18px; line-height: 1; color: #6b7280;
  background: transparent; cursor: pointer;
  transition: color .15s ease;
}
#paxEditModal .modal-header .close:hover{
  background: #f3f4f6; color: #111827;
}

/* å…§å®¹å¯æ²å‹• + å…§è· */
#paxEditModal .modal-body{
  flex: 1 1 auto; overflow: auto;
  padding: 14px 16px;
}

/* è¡¨å–®ï¼šæ¡Œæ©Ÿå…©æ¬„ã€æ‰‹æ©Ÿå–®æ¬„ */
#paxEditModal #paxEditForm{
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px 14px;
}
@media (max-width: 640px){
  #paxEditModal #paxEditForm{ grid-template-columns: 1fr; }
}

/* å–®æ¬„æ¬„ä½ï¼ˆåŸæœ¬çš„ .join-fieldï¼‰çµ±ä¸€è¦–è¦º */
#paxEditModal .join-field{
  display: flex; flex-direction: column; gap: 6px;
}

/* è®“è¼ƒé•·çš„æ¬„ä½ï¼ˆå‚™è¨»ï¼‰è‡ªå‹•ä½”å…©æ¬„ */
#paxEditModal textarea{ grid-column: 1 / -1; }

/* Label */
#paxEditModal .join-field > label{
  font-weight: 600; color: #1f2937; line-height: 1.2;
}

/* Input / Select / Textarea ä¸€è‡´åŒ– */
#paxEditModal .join-field input,
#paxEditModal .join-field select,
#paxEditModal .join-field textarea{
  width: 50%;
  padding: 10px 12px;
  border: 1px solid #d7dde6;
  border-radius: 10px;
  font-size: 14px; line-height: 1.25;
  transition: border-color .18s ease, box-shadow .18s ease;
}

/* Focus ring */
#paxEditModal .join-field input:focus,
#paxEditModal .join-field select:focus,
#paxEditModal .join-field textarea:focus{
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59,130,246,.18);
}

/* placeholder æ·¡ä¸€é» */
#paxEditModal ::placeholder{ color: #9ca3af; }

/* number å°ç®­é ­éš±è—ï¼ˆä¸€è‡´é«˜åº¦ï¼‰ */
#paxEditModal input[type="number"]::-webkit-inner-spin-button,
#paxEditModal input[type="number"]::-webkit-outer-spin-button{
  -webkit-appearance: none; margin: 0;
}
#paxEditModal input[type="number"]{ -moz-appearance: textfield; }

/* æŒ‰éˆ• */
#paxEditModal .btn-cancel,
#paxEditModal .btn-submit{
  border: 0; border-radius: 10px;
  padding: 10px 16px; font-weight: 700; cursor: pointer;
  transition: transform .06s ease, box-shadow .2s ease;
}
#paxEditModal .btn-cancel{ background: #eef2f7; color: #111827; }
#paxEditModal .btn-cancel:hover{ background: #e5eaf2; }
#paxEditModal .btn-submit{ background: #2563eb; color: #fff; }
#paxEditModal .btn-submit:hover{ background: #1e4fd6; }
#paxEditModal .btn-cancel:active,
#paxEditModal .btn-submit:active{ transform: translateY(1px); }

/* å°è¢å¹•å¾®èª¿ */
@media (max-width: 640px){
  #paxEditModal .modal-content{
    width: 94vw; max-height: min(92svh, 700px); margin: 4svh auto;
  }
  #paxEditModal .modal-body{ padding: 12px 14px; }
  #paxEditModal .modal-footer{ padding: 10px 14px; }
}


</style>

</head>
<body>
  <h1>ğŸŒ èŠ±è“®å…‰å¾©æ•‘ç½äº¤é€šåª’åˆ</h1>

  <div class="buttons">
    <a href="{% url 'find_car' %}">
      <button class="btn-main btn-driver">ğŸš— æˆ‘è¦å‡ºè»Šï¼ˆæ‰¾ä¹˜å®¢ï¼‰</button>
    </a>
    <a href="{% url 'find_people' %}">
      <button class="btn-main btn-passenger">ğŸ§ æˆ‘è¦æ­è»Šï¼ˆæ‰¾è»Šï¼‰</button>
    </a>
  </div>

  <h2>æ‰¾äººè³‡è¨Šï¼ˆå¸æ©Ÿæä¾›åº§ä½ï¼‰</h2>
  <ul id="passenger-list">
    {% for p in passengers %}
      {% if not p.is_matched %}
        <li class="card passenger-card">
          <span><b>{{ p.passenger_name }}</b> - éœ€è¦ {{ p.seats_needed }} äºº
            ({{ p.departure }} â†’ {{ p.destination }}, {{ p.date }})</span>
          <div class="actions">
            <button onclick="openPassengerModal('{{ p.id }}')">ç·¨è¼¯</button>
            <button onclick="openJoinModal('{{ p.id }}')">åƒåŠ </button>
          </div>
        </li>
      {% endif %}
    {% empty %}
      <li class="card passenger-card">ç›®å‰æ²’æœ‰éœ€æ±‚</li>
    {% endfor %}
  </ul>

<h2>æ‰¾è»Šéœ€æ±‚ï¼ˆä¹˜å®¢éœ€è¦å¸æ©Ÿï¼‰</h2>
<ul id="driver-list">
  {% include "Find/_driver_list.html" %}
</ul>


  <!-- å›åˆ°é ‚ç«¯ -->
  <button id="backToTop" onclick="window.scrollTo({top:0, behavior:'smooth'});">â¬†</button>

 <script>
/* ---------- å°å·¥å…· ---------- */
function $id(id){ return document.getElementById(id); }
function getCookie(name) {
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) return parts.pop().split(";").shift();
  return null;
}
function getFormCSRF() {
  const el = document.querySelector('#driverAuthForm input[name="csrfmiddlewaretoken"]');
  return el ? el.value : "";
}
function getCSRF() {
  return getCookie("csrftoken") || getFormCSRF() || "";
}
function showToastSafe(msg, type) {
  if (typeof showToast === "function") showToast(msg, type);
  else alert(msg);
}

/* ---------- ç®¡ç†æˆæ¬Š Modal ---------- */
function openDriverModal(id){
  const modal = $id("driverAuthModal");
  const idEl  = $id("driverAuthId");
  const pwdEl = $id("driverAuthPassword");
  if(!modal || !idEl || !pwdEl){
    alert("ç®¡ç†è¦–çª—å…ƒä»¶ç¼ºå¤±");
    return;
  }
  idEl.value = id;
  pwdEl.value = "";
  modal.style.display = "block";
  setTimeout(()=>pwdEl.focus(), 0);
}
window.closeDriverAuth = function(){
  const modal = $id("driverAuthModal");
  if(modal) modal.style.display = "none";
};

/* ---------- WebSocket å³æ™‚æ›´æ–° ---------- */
const socket = new WebSocket(
  (location.protocol === "https:" ? "wss://" : "ws://") + window.location.host + "/ws/find/"
);
socket.onopen  = () => console.log("âœ… WebSocket é€£ç·šæˆåŠŸ");
socket.onclose = () => console.log("âŒ WebSocket å·²é—œé–‰");
socket.onerror = (err) => console.error("âš ï¸ WebSocket ç™¼ç”ŸéŒ¯èª¤", err);

socket.onmessage = function (event) {
  try {
    const data = JSON.parse(event.data);

    if (data.type === "update") {
      if (data.passengers_html) {
        const plist = $id("passenger-list");
        if (plist) plist.innerHTML = data.passengers_html;
      }
      if (data.drivers_html) {
        const dlist = $id("driver-list");
        if (dlist) dlist.innerHTML = data.drivers_html;
      }
    }

    if (data.type === "join_result") {
      if (data.success) showToastSafe("âœ… æˆåŠŸåŠ å…¥ä¹˜å®¢è¡Œç¨‹ï¼", "success");
      else showToastSafe("âš ï¸ åŠ å…¥å¤±æ•—ï¼š" + (data.message || "æ²’æœ‰å¯ç”¨çš„å¸æ©Ÿ"), "error");
    }
  } catch (err) {
    console.error("âš ï¸ è§£æè¨Šæ¯å¤±æ•—", err, event.data);
  }
};

/* ---------- äº‹ä»¶å§”æ´¾ï¼šç®¡ç† / åƒåŠ  / å±•é–‹ ---------- */
document.addEventListener("click", function (e) {
  const btn = e.target.closest("[data-action]");
  if (!btn) return;

  const action   = btn.dataset.action;
  const driverId = btn.dataset.id;
  if (!action || !driverId) return;

  if (action === "manage") {
    e.preventDefault();
    openDriverModal(driverId);
    return;
  }

  if (action === "join") {
    e.preventDefault();
    const joinModal = $id("joinModal");
    const joinForm  = $id("joinForm");
    if (joinModal && joinForm) {
      joinForm.action = `/find/driver/${driverId}/join/`;
      joinModal.style.display = "block";
    }
    return;
  }

  if (action === "toggle") {
    e.preventDefault();
    const details = $id("details-" + driverId);
    const arrow   = $id("arrow-" + driverId) || btn;
    if (!details) return;

    const isOpen = details.classList.toggle("open");
    arrow.classList.toggle("open", isOpen);
    arrow.setAttribute("aria-expanded", isOpen ? "true" : "false");
    details.setAttribute("aria-hidden", isOpen ? "false" : "true");
    return;
  }
});

/* ---------- ä¾› WebSocket ç®¡ç†æ›´æ–°ï¼ˆè‹¥æœ‰éœ€è¦ï¼‰ ---------- */
window.manageDriver = function (driverId) {
  socket.send(JSON.stringify({ action: "driver_manage", driver_id: driverId }));
};


// æ‰“é–‹åƒåŠ  Modalï¼ˆä½ åœ¨ _driver_list.html çš„ã€ŒåƒåŠ ã€æŒ‰éˆ•è¦å‘¼å« openJoinModal(id)ï¼‰
  function openJoinModal(driverId){
    const m = document.getElementById('joinModal');
    const f = document.getElementById('joinForm');
    // å¾Œç«¯ç”¨é€™å€‹è·¯ç”±è™•ç†åŠ å…¥ï¼š/find/driver/<id>/join/
    f.action = `/find/driver/${driverId}/join/`;
    m.style.display = 'block';
    document.body.classList.add('body-modal-open');
    // è‡ªå‹•èšç„¦ç¬¬ä¸€å€‹æ¬„ä½
    setTimeout(() => {
      const first = f.querySelector('input,select,textarea');
      if (first) first.focus();
    }, 0);
  }

  function closeJoinModal(){
    document.getElementById('joinModal').style.display = 'none';
    document.body.classList.remove('body-modal-open');
  }
  // æ‰“é–‹å–æ¶ˆ Modalï¼ˆä½ åœ¨ä¹˜å®¢æ¸…å–®é‚£é‚Šæ”¾ä¸€é¡†ã€Œå–æ¶ˆã€æŒ‰éˆ•å‘¼å« openCancelModal(pid)ï¼‰
  function openCancelModal(passengerId) {
    const m = document.getElementById("cancelModal");
    const f = document.getElementById("cancelForm");
    document.getElementById("cancelPassengerId").value = passengerId;
    // å¾Œç«¯è·¯ç”±ï¼š/find/passenger/<pid>/cancel/
    f.action = `/find/passenger/${passengerId}/cancel/`;
    m.style.display = "block";
  }

  //ï¼ˆå¯é¸ï¼‰æ””æˆª join/cancel ä»¥ AJAX é€å‡ºï¼ŒæˆåŠŸå¾Œé—œé–‰ modal + showToast
  // å¦‚æœä½ è¦ä¿ç•™ä¸€èˆ¬ POST é‡æ–°å°å‘ä¹Ÿ OKï¼Œé€™æ®µå°±ä¸å¿…åŠ ã€‚
  (function enhanceJoinCancel() {
    const joinForm   = document.getElementById("joinForm");
    const cancelForm = document.getElementById("cancelForm");

    async function ajaxSubmit(form, okMsg) {
      const url  = form.action;
      const body = new URLSearchParams(new FormData(form));
      const res  = await fetch(url, {
        method: "POST",
        headers: { "X-Requested-With": "XMLHttpRequest" },
        body
      });
      let data = {};
      try { data = await res.json(); } catch {}
      if (res.ok && data.ok) {
        if (typeof showToast === "function") showToast(okMsg || "æˆåŠŸ", "success");
        // é—œ Modal
        form.closest(".modal").style.display = "none";
      } else {
        const msg = (data && (data.error || data.detail)) || `å¤±æ•—ï¼ˆ${res.status}ï¼‰`;
        if (typeof showToast === "function") showToast(msg, "error");
      }
    }

    if (joinForm) {
      joinForm.addEventListener("submit", async function(e) {
        // ç›´æ¥ç”¨ AJAXï¼›è‹¥æƒ³æ­£å¸¸ POST å°±æŠŠ preventDefault æ‹”æ‰
        e.preventDefault();
        await ajaxSubmit(joinForm, "âœ… å·²é€å‡ºç”³è«‹");
      });
    }
    if (cancelForm) {
      cancelForm.addEventListener("submit", async function(e) {
        e.preventDefault();
        await ajaxSubmit(cancelForm, "ğŸ—‘ï¸ å·²å–æ¶ˆ");
      });
    }
  })();


</script>

<script>
/* ====== å·¥å…· ====== */
function getCookie(name) {
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) return parts.pop().split(";").shift();
  return null;
}
function showToastSafe(msg, type) {
  if (typeof showToast === "function") showToast(msg, type);
  else alert(msg);
}

/* ====== ç¶å®šæˆæ¬Šè¡¨å–®ï¼ˆå¯é‡å…¥ï¼‰ ====== */
function bindDriverAuthForm() {
  const form   = document.getElementById("driverAuthForm");
  if (!form || form.dataset.bound === "1") return;

  const idEl  = document.getElementById("driverAuthId");
  const pwdEl = document.getElementById("driverAuthPassword");

  function getFormCSRF() {
    const el = form.querySelector('input[name="csrfmiddlewaretoken"]');
    return el ? el.value : null;
  }
  function getCSRF() {
    return getFormCSRF() || getCookie("csrftoken") || "";
  }

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const driverId = idEl && idEl.value;
    const password = pwdEl && pwdEl.value;

    if (!driverId) { console.error("ç¼º driverId"); return; }
    if (!password) { showToastSafe("è«‹è¼¸å…¥å¯†ç¢¼", "error"); pwdEl && pwdEl.focus(); return; }

    const url = `/find/driver/${driverId}/manage/auth/`;

    try {
      const res = await fetch(url, {
        method: "POST",
        credentials: "same-origin",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
          "X-CSRFToken": getCSRF(),
          "X-Requested-With": "XMLHttpRequest"
        },
        body: new URLSearchParams({ password })
      });

      let data = {};
      try { data = await res.json(); } catch (_) {}

      console.log("[auth] status:", res.status, data);

      if (res.ok && data && data.ok && data.url) {
        showToastSafe("âœ… é©—è­‰æˆåŠŸï¼Œå‰å¾€ç®¡ç†é â€¦", "success");
        // é—œæ‰ modal å†è·³è½‰
        const modal = document.getElementById("driverAuthModal");
        if (modal) modal.style.display = "none";
        window.location.href = data.url;
      } else {
        const msg = (data && (data.error || data.detail)) || `é©—è­‰å¤±æ•— (HTTP ${res.status})`;
        showToastSafe(msg, "error");
        pwdEl && pwdEl.focus();
      }
    } catch (err) {
      console.error(err);
      showToastSafe("ä¼ºæœå™¨éŒ¯èª¤ï¼Œç¨å¾Œå†è©¦", "error");
    }
  });

  form.dataset.bound = "1";
}

/* ====== é–‹é—œ Modal ====== */
window.openDriverModal = function (driverId) {
  const idEl  = document.getElementById("driverAuthId");
  const pwdEl = document.getElementById("driverAuthPassword");
  const modal = document.getElementById("driverAuthModal");
  if (!idEl || !pwdEl || !modal) { alert("ç®¡ç†è¦–çª—å…ƒä»¶ç¼ºå¤±"); return; }

  idEl.value = driverId;
  pwdEl.value = "";
  modal.style.display = "block";
  // ç¢ºä¿æ­¤æ™‚ä¹Ÿå·²ç¶åˆ° submitï¼ˆé¿å…å…ˆå‰æ²’ç¶ä¸Šï¼‰
  bindDriverAuthForm();
  setTimeout(() => pwdEl.focus(), 0);
};
window.closeDriverAuth = function () {
  const modal = document.getElementById("driverAuthModal");
  if (modal) modal.style.display = "none";
};

/* é¦–æ¬¡è¼‰å…¥æ™‚ç¶ä¸€æ¬¡ï¼ˆå¦‚æœ script åœ¨ body å°¾ç«¯ï¼Œé€™ä¸€æ­¥å°±èƒ½ç¶ä¸Šï¼‰ */
document.addEventListener("DOMContentLoaded", bindDriverAuthForm);
</script>



<!-- å¸æ©Ÿç®¡ç†æˆæ¬Š Modal -->
<div id="driverAuthModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" onclick="closeDriverAuth()">&times;</span>
    <h3>ğŸ” ç®¡ç†æˆæ¬Š</h3>
    <form id="driverAuthForm" method="POST">
  {% csrf_token %}
  <input type="hidden" id="driverAuthId" value="">
  <input id="driverAuthPassword" type="password" name="password" required>
  <button type="submit">ç¢ºèª</button>
</form>
  </div>
</div>

<!-- Toast å®¹å™¨ -->
<div id="toast-container" style="
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 2000;
"></div>

<!-- åƒåŠ è¡Œç¨‹ Modal -->
<div id="joinModal" class="modal" style="display:none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3>ğŸ§ åƒåŠ è¡Œç¨‹</h3>
      <button type="button" class="close" onclick="closeJoinModal()">Ã—</button>
    </div>

    <div class="modal-body">
      <form id="joinForm" method="POST">
        {% csrf_token %}

        <div class="join-field">
          <label>æš±ç¨±</label>
          <input type="text" name="passenger_name" required>
        </div>

        <div class="join-field">
          <label>æ€§åˆ¥</label>
          <select name="gender" required>
            <option value="X" selected>ä¸æ–¹ä¾¿é€æ¼</option>
            <option value="M">ç”·ç”Ÿ</option>
            <option value="F">å¥³ç”Ÿ</option>
          </select>
        </div>

        <div class="join-field">
          <label>Email <span class="muted">(ä¸å…¬é–‹ï¼Œç”¨æ–¼åª’åˆé€šçŸ¥)</span></label>
          <input type="email" name="email" placeholder="å¯ç•™ç©º">
        </div>

        <div class="join-field">
          <label>è¯çµ¡æ–¹å¼</label>
          <input type="text" name="contact" placeholder="LINE / IG / Phone" required>
        </div>

        <div class="join-field">
          <label>ä¸Šè»Šäººæ•¸</label>
          <input type="number" name="seats_needed" min="1" value="1" required>
        </div>

        <div class="join-field">
          <label>é¡˜ä»˜é‡‘é¡ <span class="muted">ï¼ˆå¯ç•™ç©ºï¼Œå–®ä½ NTSï¼‰</span></label>
          <input type="number" name="willing_to_pay" min="0" step="1" placeholder="å¯ç•™ç©º">
        </div>

        <!-- ä¸Šè»Šåœ°é»ï¼ˆç¸£å¸‚ä¸‹æ‹‰ + è‡ªå¡«ï¼‰ -->
        <div class="join-field">
          <label for="join-pickup-select">ä¸Šè»Šåœ°é»</label>

          <!-- ä½¿ç”¨ä¸‹æ‹‰åšé¸æ“‡ï¼ˆæ²’æœ‰ nameï¼Œé¿å…ç›´æ¥æäº¤ï¼‰ -->
          <select id="join-pickup-select">
            <option value="">è«‹é¸æ“‡ç¸£å¸‚</option>
            <option value="å…¶ä»–">å…¶ä»–</option>
            <option value="å°åŒ—å¸‚">å°åŒ—å¸‚</option>
            <option value="æ–°åŒ—å¸‚">æ–°åŒ—å¸‚</option>
            <option value="åŸºéš†å¸‚">åŸºéš†å¸‚</option>
            <option value="æ¡ƒåœ’å¸‚">æ¡ƒåœ’å¸‚</option>
            <option value="æ–°ç«¹å¸‚">æ–°ç«¹å¸‚</option>
            <option value="æ–°ç«¹ç¸£">æ–°ç«¹ç¸£</option>
            <option value="è‹—æ —ç¸£">è‹—æ —ç¸£</option>
            <option value="å°ä¸­å¸‚">å°ä¸­å¸‚</option>
            <option value="å½°åŒ–ç¸£">å½°åŒ–ç¸£</option>
            <option value="å—æŠ•ç¸£">å—æŠ•ç¸£</option>
            <option value="é›²æ—ç¸£">é›²æ—ç¸£</option>
            <option value="å˜‰ç¾©å¸‚">å˜‰ç¾©å¸‚</option>
            <option value="å˜‰ç¾©ç¸£">å˜‰ç¾©ç¸£</option>
            <option value="å°å—å¸‚">å°å—å¸‚</option>
            <option value="é«˜é›„å¸‚">é«˜é›„å¸‚</option>
            <option value="å±æ±ç¸£">å±æ±ç¸£</option>
            <option value="å®œè˜­ç¸£">å®œè˜­ç¸£</option>
            <option value="èŠ±è“®ç¸£">èŠ±è“®ç¸£</option>
            <option value="å°æ±ç¸£">å°æ±ç¸£</option>
            <option value="æ¾æ¹–ç¸£">æ¾æ¹–ç¸£</option>
            <option value="é‡‘é–€ç¸£">é‡‘é–€ç¸£</option>
            <option value="é€£æ±Ÿç¸£">é€£æ±Ÿç¸£</option>
          </select>

          <!-- è‡ªå¡«ï¼ˆé¸ã€Œå…¶ä»–ã€æ‰é¡¯ç¤ºï¼›ç„¡ nameï¼‰ -->
          <input type="text" id="join-pickup-custom" placeholder="è¼¸å…¥è‡ªè¨‚ä¸Šè»Šåœ°é»" style="display:none;">

          <!-- çœŸæ­£æäº¤ç”¨ï¼ˆæœ‰ nameï¼‰ -->
          <input type="hidden" id="join-pickup" name="departure">
        </div>


        <div class="join-field">
          <label>ç›®çš„åœ°</label>
          <input type="text" name="destination">
        </div>

        <div class="join-field">
          <label>æ˜¯å¦ä¸€èµ·å›ç¨‹ï¼Ÿ</label>
          <select name="together_return" id="join-together">
            <option value="" selected>æœªæŒ‡å®š</option>
            <option value="true">æ˜¯</option>
            <option value="false">å¦</option>
          </select>
        </div>

                <!-- å›ç¨‹æ—¥æœŸï¼ˆå¯ç•™ç©ºï¼‰ -->
        <div class="join-field" id="returnField" style="display:none;">
          <label for="join-return">å›ç¨‹æ—¥æœŸï¼ˆå¯ç•™ç©ºï¼‰</label>
          <input type="date" id="join-return" name="return_date" placeholder="å¯ç•™ç©º">
        </div>

        <div class="join-field">
          <label>ç®¡ç†å¯†ç¢¼ <span class="muted">ï¼ˆå»ºè­° 4 ç¢¼ï¼Œä¾›å–æ¶ˆ/ç·¨è¼¯ç”¨ï¼Œé è¨­0000ï¼‰</span></label>
          <input type="password" name="password" placeholder="å»ºè­° 4 ç¢¼" defaultValue="0000">
        </div>

        <div class="join-field">
          <label>å‚™è¨» <span class="muted">ï¼ˆå¯è¼¸å…¥åŒè¡Œäººã€å…·é«”éœ€æ±‚â€¦ï¼‰</span></label>
          <textarea name="note" rows="3" placeholder=""></textarea>
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button type="button" class="btn-cancel" onclick="closeJoinModal()">å–æ¶ˆ</button>
      <button type="submit" form="joinForm" class="btn-submit">é€å‡º</button>
    </div>
  </div>
</div>

<!-- ä¹˜å®¢ç·¨è¼¯æˆæ¬Š Modal -->
<div id="paxAuthModal" class="modal" style="display:none;">
  <div class="modal-content" style="max-width:420px;">
    <div class="modal-header">
      <span class="title">ğŸ” ç·¨è¼¯æˆæ¬Š</span>
      <button class="close" onclick="closePaxAuth()">&times;</button>
    </div>
    <div class="modal-body">
      <form id="paxAuthForm" method="POST">
        {% csrf_token %}
        <input type="hidden" id="paxAuthId" name="id">
        <div class="join-field">
          <label>ç®¡ç†å¯†ç¢¼</label>
          <input type="password" id="paxAuthPassword" name="password" placeholder="è«‹è¼¸å…¥ä¹˜å®¢ç®¡ç†å¯†ç¢¼" required>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closePaxAuth()">å–æ¶ˆ</button>
      <button class="btn-submit" onclick="submitPaxAuth()">ç¢ºèª</button>
    </div>
  </div>
</div>
<!-- ä¹˜å®¢ç·¨è¼¯ Modal -->
<div id="paxEditModal" class="modal" style="display:none;">
  <div class="modal-content">
    <div class="modal-header">
      <span class="title">âœï¸ ç·¨è¼¯ä¹˜å®¢</span>
      <button class="close" onclick="closePaxEdit()">&times;</button>
    </div>
    <div class="modal-body">
      <form id="paxEditForm">
        {% csrf_token %}
        <input type="hidden" id="paxEditId" name="id">

        <div class="join-field">
          <label>æš±ç¨±</label>
          <input type="text" id="paxName" name="passenger_name" required>
        </div>

        <div class="join-field">
          <label>æ€§åˆ¥</label>
          <select id="paxGender" name="gender">
            <option value="X">ä¸æ–¹ä¾¿é€æ¼</option>
            <option value="M">ç”·ç”Ÿ</option>
            <option value="F">å¥³ç”Ÿ</option>
          </select>
        </div>

        <div class="join-field">
          <label>Emailï¼ˆä¸å…¬é–‹ï¼‰</label>
          <input type="email" id="paxEmail" name="email" placeholder="å¯ç©ºç™½">
        </div>

        <div class="join-field">
          <label>è¯çµ¡æ–¹å¼</label>
          <input type="text" id="paxContact" name="contact" placeholder="LINE / IG / Phone">
        </div>

        <div class="join-field">
          <label>ä¸Šè»Šäººæ•¸</label>
          <input type="number" id="paxSeats" name="seats_needed" min="1" value="1">
        </div>

        <div class="join-field">
          <label>é¡˜ä»˜é‡‘é¡ï¼ˆå¯ç©ºï¼‰</label>
          <input type="text" id="paxPay" name="willing_to_pay" placeholder="ä¾‹å¦‚ 300">
        </div>

        <div class="join-field">
          <label>ä¸Šè»Šåœ°é»</label>
          <input type="text" id="paxDeparture" name="departure">
        </div>

        <div class="join-field">
          <label>ç›®çš„åœ°</label>
          <input type="text" id="paxDestination" name="destination">
        </div>

        <div class="join-field">
          <label>å‡ºç™¼æ—¥æœŸ</label>
          <input type="date" id="paxDate" name="date">
        </div>

        <div class="join-field">
          <label>å›ç¨‹æ—¥æœŸï¼ˆå¯ç•™ç©ºï¼‰</label>
          <input type="date" id="paxReturn" name="return_date">
        </div>

        <div class="join-field">
          <label>æ˜¯å¦ä¸€èµ·å›ç¨‹</label>
          <select id="paxTogether" name="together_return">
            <option value="">æœªæŒ‡å®š</option>
            <option value="true">æ˜¯</option>
            <option value="false">å¦</option>
          </select>
        </div>

        <div class="join-field">
          <label>å‚™è¨»</label>
          <textarea id="paxNote" name="note" rows="3"></textarea>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closePaxEdit()">å–æ¶ˆ</button>
      <button class="btn-submit" onclick="submitPaxEdit()">å„²å­˜</button>
    </div>
  </div>
</div>

<!-- ä¹˜å®¢åˆªé™¤ Modalï¼ˆç°¡å–®ç¢ºèªï¼‰ -->
<div id="paxDelModal" class="modal" style="display:none;">
  <div class="modal-content">
    <div class="modal-header">
      <span class="title">ğŸ—‘ åˆªé™¤ä¹˜å®¢</span>
      <button class="close" onclick="closePaxDel()">&times;</button>
    </div>
    <div class="modal-body">
      <p>ç¢ºå®šè¦åˆªé™¤é€™ä½ä¹˜å®¢å—ï¼Ÿæ­¤å‹•ä½œç„¡æ³•å¾©åŸã€‚</p>
      <input type="hidden" id="paxDelId">
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closePaxDel()">å–æ¶ˆ</button>
      <button class="btn-submit" style="background:#e11d48" onclick="confirmPaxDel()">åˆªé™¤</button>
    </div>
  </div>
</div>


<script>
  // é€™å…©å€‹æœƒåœ¨ openJoinModal æ™‚è¢«è¨­å®š
let currentDriverDate = "";
let currentDriverReturn = "";

// å¿«å–å…ƒç´ 
const togetherSel  = document.getElementById("join-together");
const departInput  = document.getElementById("join-date");
const returnWrap   = document.getElementById("returnField");
const returnInput  = document.getElementById("join-return");
// åˆ‡æ›ã€Œæ˜¯å¦ä¸€èµ·å›ç¨‹ï¼Ÿã€æ™‚çš„è¡Œç‚º
function handleTogetherChange() {
  const v = togetherSel ? togetherSel.value : "";

  // åŒæ­¥æœ€å°å›ç¨‹æ—¥ï¼šä¸å¯æ—©æ–¼å‡ºç™¼æ—¥æˆ–å¸æ©Ÿå‡ºç™¼æ—¥
  if (returnInput) {
    // ä»¥å‡ºç™¼æ—¥ç‚ºå„ªå…ˆï¼Œå…¶æ¬¡ç”¨å¸æ©Ÿçš„å‡ºç™¼æ—¥ï¼ˆå‚™æ´ï¼‰
    const minBase = (departInput && departInput.value) || currentDriverDate || "";
    returnInput.min = minBase;
  }

  if (v === "false") {
    // å¦ï¼šæ‰‹å‹•é¸æ“‡ â†’ é¡¯ç¤ºã€å¯ç·¨è¼¯
    if (returnWrap) returnWrap.style.display = "block";
    if (returnInput) {
      returnInput.readOnly = false; // ä¸è¦ disabledï¼Œé¿å…ä¸é€å€¼
      if (!returnInput.value && returnInput.min) {
        returnInput.value = returnInput.min; // å¹«å€‹å¿™å¸¶å‡ºç™¼æ—¥ç•¶èµ·é»
      }
    }
  } else if (v === "true") {
    // æ˜¯ï¼šè·Ÿå¸æ©Ÿ â†’ å°‡å¸æ©Ÿå›ç¨‹æ—¥æœŸå¸¶å…¥ï¼Œæ¬„ä½å”¯è®€ï¼ˆæœ‰å€¼æ‰é¡¯ç¤ºï¼‰
    const hasReturn = !!currentDriverReturn;
    if (returnWrap) returnWrap.style.display = hasReturn ? "block" : "none";

    if (returnInput) {
      returnInput.readOnly = true;
      returnInput.value = hasReturn ? currentDriverReturn : "";
    }
  } else {
    // æœªæŒ‡å®šï¼šéš±è— & æ¸…ç©º
    if (returnWrap) returnWrap.style.display = "none";
    if (returnInput) {
      returnInput.readOnly = false;
      returnInput.value = "";
    }
  }
}

// å‡ºç™¼æ—¥è®Šæ›´æ™‚ï¼Œæ›´æ–°å›ç¨‹æœ€å°æ—¥
if (departInput) {
  departInput.addEventListener("change", () => {
    if (returnInput) {
      const minBase = departInput.value || currentDriverDate || "";
      returnInput.min = minBase;
      if (returnInput.value && minBase && returnInput.value < minBase) {
        returnInput.value = ""; // ç„¡æ•ˆå°±æ¸…æ‰
      }
    }
  });
}

// æ‰“é–‹ Join Modalï¼ˆäº‹ä»¶å§”æ´¾é‚£é‚Šå‘¼å«æ™‚è¦æŠŠ data å‚³é€²ä¾†ï¼‰
function openJoinModal(driverId, driverDate = "", driverReturn = "") {
  currentDriverDate = driverDate || "";
  currentDriverReturn = driverReturn || "";

  // å°‡å‡ºç™¼æ—¥é è¨­åˆ°å¸æ©Ÿå‡ºç™¼æ—¥ï¼ˆè‹¥ä½ æƒ³é è¨­ï¼‰
  if (departInput && currentDriverDate) {
    departInput.value = currentDriverDate;
  }

  // é‡ç½® together å›é¸å–® â†’ æœªæŒ‡å®š
  if (togetherSel) togetherSel.value = "";

  // å›ç¨‹æ¬„ä½é‡ç½®
  if (returnInput) {
    returnInput.value = "";
    returnInput.readOnly = false;
  }
  if (returnWrap) returnWrap.style.display = "none";

  // æŠŠæœ€å°æ—¥å…ˆè¨­å¥½
  if (returnInput) {
    returnInput.min = (departInput && departInput.value) || currentDriverDate || "";
  }

  // ä½ çš„é–‹å•Ÿ modal æ—¢æœ‰ç¨‹å¼ï¼ˆä¿æŒï¼‰
  const joinModal = document.getElementById("joinModal");
  const joinForm  = document.getElementById("joinForm");
  if (joinForm) joinForm.action = `/find/driver/${driverId}/join/`;
  if (joinModal) joinModal.style.display = "block";
}

// ç¶å®š select äº‹ä»¶
if (togetherSel) {
  togetherSel.addEventListener("change", handleTogetherChange);
}

// äº‹ä»¶å§”æ´¾çš„ join åˆ†æ”¯ï¼Œè¨˜å¾—æŠŠ data-date / data-return å‚³é€²ä¾†
document.addEventListener("click", function (e) {
  const btn = e.target.closest("[data-action]");
  if (!btn) return;

  const action   = btn.dataset.action;
  const driverId = btn.dataset.id;

  if (action === "join") {
    e.preventDefault();
    const dDate   = btn.dataset.date   || ""; // å¸æ©Ÿå‡ºç™¼æ—¥ YYYY-MM-DD
    const dReturn = btn.dataset.return || ""; // å¸æ©Ÿå›ç¨‹æ—¥ï¼ˆå¯èƒ½ç©ºï¼‰
    openJoinModal(driverId, dDate, dReturn);
  }
});

(function () {
  

  if (!departInput || !returnInput) return;

  function syncReturnMin() {
    // å›ç¨‹æœ€æ—©ä¸å¾—æ—©æ–¼å‡ºç™¼
    returnInput.min = departInput.value || "";
    if (returnInput.value && departInput.value && returnInput.value < departInput.value) {
      returnInput.value = "";
    }
  }

  // æ‰“é–‹ modal æ™‚å¯å‘¼å«ä¸€æ¬¡ï¼Œç¢ºä¿ç‹€æ…‹ä¹¾æ·¨
  window.resetReturnDate = function () {
    if (returnInput) returnInput.value = "";
    syncReturnMin();
  };

  departInput.addEventListener("change", syncReturnMin);
})();
</script>

<script>
(function () {
  // é€™å…©å€‹æœƒåœ¨ openJoinModal æ™‚è¢«è¨­å®š
  const sel    = document.getElementById("join-pickup-select");
  const custom = document.getElementById("join-pickup-custom");
  const hidden = document.getElementById("join-pickup"); // name="departure"

  if (!sel || !custom || !hidden) return;

  function syncHidden() {
    if (sel.value === "å…¶ä»–") {
      hidden.value = (custom.value || "").trim();
    } else {
      hidden.value = sel.value || "";
    }
  }

  sel.addEventListener("change", () => {
    if (sel.value === "å…¶ä»–") {
      custom.style.display = "block";
      custom.focus();
    } else {
      custom.style.display = "none";
      custom.value = "";
    }
    syncHidden();
  });

  custom.addEventListener("input", syncHidden);

  // ä¿éšªï¼šé€å‡ºå‰å†æ¬¡åŒæ­¥ä¸€æ¬¡
  const joinForm = document.getElementById("joinForm");
  if (joinForm) {
    joinForm.addEventListener("submit", () => {
      syncHidden();
    });
  }

  // æ¯æ¬¡æ‰“é–‹ Modal ä¹Ÿé‡ç½®ä¸€ä¸‹ï¼ˆä½ çš„ openJoinModal è£¡é¢å‘¼å«ï¼‰
  window.resetPickupField = function () {
    sel.value = "";
    custom.value = "";
    custom.style.display = "none";
    hidden.value = "";
  };
})();
</script>

<script>
// ===== å…±ç”¨å°å·¥å…· =====
function getCSRF(){
  const el = document.querySelector('input[name="csrfmiddlewaretoken"]');
  return el ? el.value : '';
}
function toast(msg, type="info"){
  if (typeof showToast === "function") showToast(msg, type);
  else alert(msg);
}

// ===== ç‹€æ…‹ï¼šä¸‹ä¸€æ­¥å‹•ä½œï¼ˆ'edit' | 'delete'ï¼‰=====
let __paxNextAction = null;

// ===== å¯†ç¢¼ Modal =====
function openPaxAuth(pid){
  document.getElementById("paxAuthId").value = pid;
  document.getElementById("paxAuthPassword").value = "";
  document.getElementById("paxAuthModal").style.display = "block";
  setTimeout(()=>document.getElementById("paxAuthPassword").focus(), 0);
}
function closePaxAuth(){ document.getElementById("paxAuthModal").style.display = "none"; }

// ===== ç·¨è¼¯ Modal =====
function openPaxEdit(){ document.getElementById("paxEditModal").style.display = "block"; }
function closePaxEdit(){ document.getElementById("paxEditModal").style.display = "none"; }

// ===== äº‹ä»¶å§”æ´¾ï¼šç·¨è¼¯ / åˆªé™¤ =====
document.addEventListener("click", function(e){
  // ç·¨è¼¯
  const editBtn = e.target.closest("[data-pax-edit]");
  if (editBtn){
    e.preventDefault();
    __paxNextAction = "edit";
    openPaxAuth(editBtn.dataset.id);
    return;
  }
  // åˆªé™¤
  const delBtn = e.target.closest("[data-pax-del]");
  if (delBtn){
    e.preventDefault();
    __paxNextAction = "delete";
    openPaxAuth(delBtn.dataset.id);
    return;
  }
});

// ===== é€å¯†ç¢¼ â†’ é©—è­‰ â†’ ä¾ nextAction åŸ·è¡Œ =====
async function submitPaxAuth(){
  const pid = document.getElementById("paxAuthId").value;
  const pwd = document.getElementById("paxAuthPassword").value;
  if(!pid || !pwd){ toast("è«‹è¼¸å…¥å¯†ç¢¼", "error"); return; }

  try{
    const res = await fetch(`/find/pax/${pid}/auth/`, {
      method: "POST",
      headers: {
        "X-CSRFToken": getCSRF(),
        "X-Requested-With": "XMLHttpRequest",
        "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
      },
      body: new URLSearchParams({ password: pwd })
    });
    let data = {};
    try{ data = await res.json(); }catch(_){}
    if(!res.ok || !data.ok){ toast(data.error || "é©—è­‰å¤±æ•—", "error"); return; }

    closePaxAuth();

    if (__paxNextAction === "delete"){
      // èµ°åˆªé™¤æµç¨‹
      await doPaxDelete(pid);
      return;
    }

    // èµ°ç·¨è¼¯æµç¨‹ï¼šæŠ“è³‡æ–™æ‰“é–‹ Modal
    const res2 = await fetch(`/find/pax/${pid}/get/`, {
      headers: { "X-Requested-With":"XMLHttpRequest" }
    });
    const data2 = await res2.json();
    if(!res2.ok || !data2.ok){ toast(data2.error || "è®€å–è³‡æ–™å¤±æ•—", "error"); return; }

    const p = data2.p;
    document.getElementById("paxEditId").value = p.id;
    document.getElementById("paxName").value = p.passenger_name || "";
    document.getElementById("paxGender").value = p.gender || "X";
    document.getElementById("paxEmail").value = p.email || "";
    document.getElementById("paxContact").value = p.contact || "";
    document.getElementById("paxSeats").value = p.seats_needed || 1;
    document.getElementById("paxPay").value = p.willing_to_pay || "";
    document.getElementById("paxDeparture").value = p.departure || "";
    document.getElementById("paxDestination").value = p.destination || "";
    document.getElementById("paxDate").value = p.date || "";
    document.getElementById("paxReturn").value = p.return_date || "";
    document.getElementById("paxTogether").value = p.together_return || "";
    document.getElementById("paxNote").value = p.note || "";

    openPaxEdit();
  }catch(err){
    console.error(err);
    toast("ä¼ºæœå™¨éŒ¯èª¤ï¼Œç¨å¾Œå†è©¦", "error");
  }finally{
    __paxNextAction = null;
  }
}

// ===== å„²å­˜ç·¨è¼¯ =====
async function submitPaxEdit(){
  const form = document.getElementById("paxEditForm");
  const pid  = document.getElementById("paxEditId").value;
  const body = new URLSearchParams(new FormData(form));

  try{
    const res = await fetch(`/find/pax/${pid}/update/`, {
      method: "POST",
      headers: {
        "X-CSRFToken": getCSRF(),
        "X-Requested-With": "XMLHttpRequest",
        "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
      },
      body
    });
    const data = await res.json();
    if(!res.ok || !data.ok){
      toast(data.error || "æ›´æ–°å¤±æ•—", "error");
      return;
    }
    toast("âœ… å·²æ›´æ–°ä¹˜å®¢è³‡æ–™", "success");
    closePaxEdit();
    // é€™è£¡å¯è§¸ç™¼ä½ æ—¢æœ‰ WebSocket å³æ™‚åˆ·æ–°ï¼›æˆ–æš«æ™‚ç”¨é‡æ•´
    // location.reload();
  }catch(err){
    console.error(err);
    toast("ä¼ºæœå™¨éŒ¯èª¤ï¼Œç¨å¾Œå†è©¦", "error");
  }
}

// ===== åˆªé™¤ï¼ˆå·²æˆæ¬Šï¼‰ =====
async function doPaxDelete(pid){
  if (!confirm("ç¢ºå®šè¦åˆªé™¤é€™ä½ä¹˜å®¢å—ï¼Ÿæ­¤å‹•ä½œç„¡æ³•å¾©åŸã€‚")) return;

  try{
        const res = await fetch(`/find/pax/${pid}/delete/`, {   // â† æ³¨æ„æœ€å¾Œçš„æ–œç·š
      method: "POST",
      headers: {
        "X-CSRFToken": getCSRF(),
        "X-Requested-With": "XMLHttpRequest",
        "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
      },
      body: new URLSearchParams()
    });
    const data = await res.json();
    if(!res.ok || !data.ok){
      toast(data.error || "åˆªé™¤å¤±æ•—", "error");
      return;
    }
    toast("ğŸ—‘ï¸ å·²åˆªé™¤ä¹˜å®¢", "success");
    // é€™è£¡å»ºè­°è§¸ç™¼ä½ ç›®å‰çš„ WS é‡æ–°æ¸²æŸ“ï¼›æˆ–å…ˆç”¨é‡æ•´
    // location.reload();
  }catch(err){
    console.error(err);
    toast("ä¼ºæœå™¨éŒ¯èª¤ï¼Œç¨å¾Œå†è©¦", "error");
  }
}
</script>

<script>
  (function () {
    const togetherSel = document.getElementById('paxTogether');
    const returnInput = document.getElementById('paxReturn');

    function syncReturnState() {
      const val = togetherSel.value;
      if (val === 'true') {
        returnInput.value = '';
        returnInput.disabled = true;
        returnInput.placeholder = 'èˆ‡å¸æ©Ÿå›ç¨‹æ—¥æœŸç›¸åŒ';
        returnInput.classList.add('is-disabled');
      } else {
        returnInput.disabled = false;
        returnInput.placeholder = '';
        returnInput.classList.remove('is-disabled');
      }
    }
    if (togetherSel && returnInput) {
      togetherSel.addEventListener('change', syncReturnState);
      // æ‰“é–‹ modal æ™‚å¯å†å‘¼å«ä¸€æ¬¡ syncReturnState()
    }
  })();


  // è¨˜ä½ç›®å‰å±•é–‹çš„ driver ids
function snapshotOpenDrivers() {
  return Array.from(document.querySelectorAll('#driver-list .details.open'))
    .map(el => el.id.replace('details-', ''));
}

// å°‡å±•é–‹ç‹€æ…‹é‚„åŸå›å»ï¼ˆä¹Ÿé †ä¾¿æ¢å¾©ç®­é ­ ariaï¼‰
function restoreOpenDrivers(openIds) {
  openIds.forEach(id => {
    const details = document.getElementById('details-' + id);
    const arrow   = document.getElementById('arrow-' + id);
    if (details) {
      details.classList.add('open');
      details.setAttribute('aria-hidden', 'false');
    }
    if (arrow) {
      arrow.classList.add('open');
      arrow.setAttribute('aria-expanded', 'true');
    }
  });
}
function replaceDriverListSafely(newHtml) {
  const list = document.getElementById('driver-list');
  if (!list) return;

  const openIds   = snapshotOpenDrivers();   // 1) è¨˜ä½å“ªäº›æ˜¯å±•é–‹çš„
  const scrollY   = window.scrollY;          // 2) è¨˜ä½æ²å‹•ä½ç½®ï¼ˆå¯é¸ï¼‰

  list.innerHTML = newHtml;                  // 3) æ›¿æ› HTML

  restoreOpenDrivers(openIds);               // 4) é‚„åŸå±•é–‹çš„å¡ç‰‡
  window.scrollTo(0, scrollY);               // 5) é‚„åŸæ²å‹•ï¼ˆå¯é¸ï¼‰
}

// å¦‚æœä½ åŒæ™‚æœƒæ›´æ–°ä¹˜å®¢æ¸…å–®ï¼š
function replaceLists(data) {
  if (data.drivers_html) {
    replaceDriverListSafely(data.drivers_html);
  }
  if (data.passengers_html) {
    const p = document.getElementById('passenger-list');
    if (p) p.innerHTML = data.passengers_html;
  }
}

</script>



</body>
</html>
