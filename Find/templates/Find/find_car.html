<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>ğŸš— æ–°å¢å‡ºè»Šè³‡è¨Š</title>
  <style>
    body { font-family:"Microsoft JhengHei",sans-serif; background:linear-gradient(to right,#f0f9ff,#fefefe); margin:0; padding:40px 20px; }
    h2 { text-align:center; color:#005c4b; margin-bottom:25px; font-size:26px; }
    form { max-width:600px; margin:0 auto; background:#fff; padding:25px 30px; border-radius:16px; box-shadow:0 6px 12px rgba(0,0,0,.1); animation:fadeIn .5s ease-in-out; }
    label { font-weight:700; display:block; margin-top:12px; margin-bottom:6px; color:#444; }
    input,textarea,select { width:100%; padding:12px; margin-bottom:10px; border-radius:10px; border:1px solid #ccc; transition:border-color .3s, box-shadow .3s; font-size:15px; }
    input:focus,textarea:focus,select:focus { border-color:#007bff; box-shadow:0 0 8px rgba(0,123,255,.3); outline:none; }
    textarea { min-height:80px; resize:vertical; }
    button { width:100%; padding:14px; border:0; border-radius:10px; background:linear-gradient(45deg,#007bff,#00b894); color:#fff; font-size:18px; font-weight:700; cursor:pointer; transition:background .3s, transform .2s; }
    button:hover { background:linear-gradient(45deg,#0056b3,#009e77); transform:scale(1.02); }
    .alert { max-width:600px; margin:0 auto 12px; padding:12px 14px; border-radius:10px; }
    .alert-danger { background:#fdeaea; color:#7f1d1d; border:1px solid #f5c2c7; }
    @keyframes fadeIn { from{opacity:0; transform:translateY(20px)} to{opacity:1; transform:translateY(0)} }
    .required::after{ content:" *"; color:red; }
  </style>
</head>
<body>
  <h2>ğŸš— æ–°å¢å‡ºè»Šè³‡è¨Š</h2>
  <form method="POST" id="driverCreateForm">
    {% csrf_token %}

    <label for="nickname" class="required">æš±ç¨±</label>
    <input type="text" name="name" id="nickname" value="{{ prefill.name|default:'' }}" required />

    <label for="gender" class="required">æ€§åˆ¥</label>
    <select name="gender" id="gender" required>
      <option value="" {% if not prefill.gender %}selected{% endif %}>æœªæŒ‡å®š</option>
      <option value="M" {% if prefill.gender == 'M' %}selected{% endif %}>ç”·ç”Ÿ</option>
      <option value="F" {% if prefill.gender == 'F' %}selected{% endif %}>å¥³ç”Ÿ</option>
      <option value="X" {% if prefill.gender == 'X' %}selected{% endif %}>ä¸æ–¹ä¾¿é€æ¼</option>
    </select>

    <label for="email">Email</label>
    <input type="email" name="email" id="email" value="{{ prefill.email|default:'' }}" placeholder="é¸å¡«ç™½ï¼Œåƒ…ç”¨æ–¼å¯„é€é€šçŸ¥" />

    <label for="contact" class="required">è¯çµ¡æ–¹å¼</label>
    <input type="text" name="contact" id="contact" value="{{ prefill.contact|default:'' }}" placeholder="LINEã€IG æˆ–æ‰‹æ©Ÿè™Ÿç¢¼" required />

    <label for="password" class="required">ç®¡ç†å¯†ç¢¼</label>
    <input type="password" name="password" id="password" value="{{ prefill.password|default:'' }}" placeholder="å»ºè­° 4 ç¢¼ï¼Œé è¨­ 0000 æ–¹ä¾¿ç®¡ç†" required />

    <label for="flexible_pickup" class="required">é †è·¯æ¥é€æ„é¡˜</label>
    <select name="flexible_pickup" id="flexible_pickup" required>
      <option value="YES"  {% if prefill.flexible_pickup == 'YES' %}selected{% endif %}>é †è·¯å¯è¼‰</option>
      <option value="NO"   {% if prefill.flexible_pickup == 'NO' %}selected{% endif %}>ä¸é †è·¯ä¹ŸOK</option>
      <option value="MAYBE" {% if prefill.flexible_pickup == 'MAYBE' or not prefill.flexible_pickup %}selected{% endif %}>è¦–æƒ…æ³</option>
    </select>

    <label for="seats_total" class="required">ç¸½åº§ä½</label>
    <input type="number" name="seats_total" id="seats_total" min="1" value="{{ prefill.seats_total|default:'1' }}" required />

    <label for="departure" class="required">å‡ºç™¼åœ°</label>
    <select name="departure" id="departure" onchange="checkCustomDeparture(this)" required>
      <option value="" {% if not prefill.departure %}selected{% endif %}>è«‹é¸æ“‡ç¸£å¸‚</option>
      <option value="è‡ªå¡«" {% if prefill.departure == 'è‡ªå¡«' %}selected{% endif %}>å…¶ä»–</option>
      <option value="èŠ±è“®ç¸£å…‰å¾©é„‰"  {% if prefill.destination == 'èŠ±è“®ç¸£å…‰å¾©é„‰' %}selected{% endif %}>èŠ±è“®ç¸£å…‰å¾©é„‰</option>
      <option value="èŠ±è“®ç¸£å…‰å¾©è»Šç«™ä»¥å¤–ç«è»Šç«™"  {% if prefill.destination == 'èŠ±è“®ç¸£å…‰å¾©è»Šç«™ä»¥å¤–ç«è»Šç«™' %}selected{% endif %}>èŠ±è“®ç¸£å…‰å¾©è»Šç«™ä»¥å¤–ç«è»Šç«™</option>
      <option value="èŠ±è“®ç¸£å…‰å¾©è»Šç«™"  {% if prefill.destination == 'èŠ±è“®ç¸£å…‰å¾©è»Šç«™' %}selected{% endif %}>èŠ±è“®ç¸£å…‰å¾©è»Šç«™</option>
      <option value="å…‰å¾©é„‰ç³–å» "  {% if prefill.destination == 'å…‰å¾©é„‰ç³–å» ' %}selected{% endif %}>å…‰å¾©é„‰ç³–å» </option>
      <option value="éœ€æ¸…æ·¤åœ°å€"  {% if prefill.destination == 'éœ€æ¸…æ·¤åœ°å€' %}selected{% endif %}>éœ€æ¸…æ·¤åœ°å€</option>
      <option value="å°åŒ—å¸‚"  {% if prefill.departure == 'å°åŒ—å¸‚' %}selected{% endif %}>å°åŒ—å¸‚</option>
      <option value="æ–°åŒ—å¸‚"  {% if prefill.departure == 'æ–°åŒ—å¸‚' %}selected{% endif %}>æ–°åŒ—å¸‚</option>
      <option value="åŸºéš†å¸‚"  {% if prefill.departure == 'åŸºéš†å¸‚' %}selected{% endif %}>åŸºéš†å¸‚</option>
      <option value="æ¡ƒåœ’å¸‚"  {% if prefill.departure == 'æ¡ƒåœ’å¸‚' %}selected{% endif %}>æ¡ƒåœ’å¸‚</option>
      <option value="æ–°ç«¹å¸‚"  {% if prefill.departure == 'æ–°ç«¹å¸‚' %}selected{% endif %}>æ–°ç«¹å¸‚</option>
      <option value="æ–°ç«¹ç¸£"  {% if prefill.departure == 'æ–°ç«¹ç¸£' %}selected{% endif %}>æ–°ç«¹ç¸£</option>
      <option value="è‹—æ —ç¸£"  {% if prefill.departure == 'è‹—æ —ç¸£' %}selected{% endif %}>è‹—æ —ç¸£</option>
      <option value="å°ä¸­å¸‚"  {% if prefill.departure == 'å°ä¸­å¸‚' %}selected{% endif %}>å°ä¸­å¸‚</option>
      <option value="å½°åŒ–ç¸£"  {% if prefill.departure == 'å½°åŒ–ç¸£' %}selected{% endif %}>å½°åŒ–ç¸£</option>
      <option value="å—æŠ•ç¸£"  {% if prefill.departure == 'å—æŠ•ç¸£' %}selected{% endif %}>å—æŠ•ç¸£</option>
      <option value="é›²æ—ç¸£"  {% if prefill.departure == 'é›²æ—ç¸£' %}selected{% endif %}>é›²æ—ç¸£</option>
      <option value="å˜‰ç¾©å¸‚"  {% if prefill.departure == 'å˜‰ç¾©å¸‚' %}selected{% endif %}>å˜‰ç¾©å¸‚</option>
      <option value="å˜‰ç¾©ç¸£"  {% if prefill.departure == 'å˜‰ç¾©ç¸£' %}selected{% endif %}>å˜‰ç¾©ç¸£</option>
      <option value="å°å—å¸‚"  {% if prefill.departure == 'å°å—å¸‚' %}selected{% endif %}>å°å—å¸‚</option>
      <option value="é«˜é›„å¸‚"  {% if prefill.departure == 'é«˜é›„å¸‚' %}selected{% endif %}>é«˜é›„å¸‚</option>
      <option value="å±æ±ç¸£"  {% if prefill.departure == 'å±æ±ç¸£' %}selected{% endif %}>å±æ±ç¸£</option>
      <option value="å®œè˜­ç¸£"  {% if prefill.departure == 'å®œè˜­ç¸£' %}selected{% endif %}>å®œè˜­ç¸£</option>
      <option value="èŠ±è“®ç¸£"  {% if prefill.departure == 'èŠ±è“®ç¸£' %}selected{% endif %}>èŠ±è“®ç¸£</option>
      <option value="å°æ±ç¸£"  {% if prefill.departure == 'å°æ±ç¸£' %}selected{% endif %}>å°æ±ç¸£</option>
      <option value="æ¾æ¹–ç¸£"  {% if prefill.departure == 'æ¾æ¹–ç¸£' %}selected{% endif %}>æ¾æ¹–ç¸£</option>
      <option value="é‡‘é–€ç¸£"  {% if prefill.departure == 'é‡‘é–€ç¸£' %}selected{% endif %}>é‡‘é–€ç¸£</option>
      <option value="é€£æ±Ÿç¸£"  {% if prefill.departure == 'é€£æ±Ÿç¸£' %}selected{% endif %}>é€£æ±Ÿç¸£</option>
    </select>

    {# æ³¨æ„ï¼šname è¦å« departure_customï¼ˆå¾Œç«¯æ‰æ¥å¾—åˆ°ï¼‰ #}
    <input type="text" id="customDeparture" name="departure_custom"
           value="{{ prefill.departure_custom|default:'' }}"
           style="display:{% if prefill.departure == 'è‡ªå¡«' or prefill.departure_custom %}block{% else %}none{% endif %};"
           placeholder="è¼¸å…¥è‡ªè¨‚å‡ºç™¼åœ°" />

    <label for="destination">ç›®çš„åœ°</label>
<select name="destination" id="destination" onchange="checkCustomDestination(this)">
  <option value="" {% if not prefill.destination %}selected{% endif %}>è«‹é¸æ“‡ç¸£å¸‚</option>
  <option value="è‡ªå¡«" {% if prefill.destination == 'è‡ªå¡«' %}selected{% endif %}>å…¶ä»–</option>
  <option value="èŠ±è“®ç¸£å…‰å¾©é„‰"  {% if prefill.destination == 'èŠ±è“®ç¸£å…‰å¾©é„‰' %}selected{% endif %}>èŠ±è“®ç¸£å…‰å¾©é„‰</option>
  <option value="èŠ±è“®ç¸£å…‰å¾©è»Šç«™ä»¥å¤–ç«è»Šç«™"  {% if prefill.destination == 'èŠ±è“®ç¸£å…‰å¾©è»Šç«™ä»¥å¤–ç«è»Šç«™' %}selected{% endif %}>èŠ±è“®ç¸£å…‰å¾©è»Šç«™ä»¥å¤–ç«è»Šç«™</option>
  <option value="èŠ±è“®ç¸£å…‰å¾©è»Šç«™"  {% if prefill.destination == 'èŠ±è“®ç¸£å…‰å¾©è»Šç«™' %}selected{% endif %}>èŠ±è“®ç¸£å…‰å¾©è»Šç«™</option>
  <option value="å…‰å¾©é„‰ç³–å» "  {% if prefill.destination == 'å…‰å¾©é„‰ç³–å» ' %}selected{% endif %}>å…‰å¾©é„‰ç³–å» </option>
  <option value="éœ€æ¸…æ·¤åœ°å€"  {% if prefill.destination == 'éœ€æ¸…æ·¤åœ°å€' %}selected{% endif %}>éœ€æ¸…æ·¤åœ°å€</option>
  <option value="å°åŒ—å¸‚"  {% if prefill.destination == 'å°åŒ—å¸‚' %}selected{% endif %}>å°åŒ—å¸‚</option>
  <option value="æ–°åŒ—å¸‚"  {% if prefill.destination == 'æ–°åŒ—å¸‚' %}selected{% endif %}>æ–°åŒ—å¸‚</option>
  <option value="åŸºéš†å¸‚"  {% if prefill.destination == 'åŸºéš†å¸‚' %}selected{% endif %}>åŸºéš†å¸‚</option>
  <option value="æ¡ƒåœ’å¸‚"  {% if prefill.destination == 'æ¡ƒåœ’å¸‚' %}selected{% endif %}>æ¡ƒåœ’å¸‚</option>
  <option value="æ–°ç«¹å¸‚"  {% if prefill.destination == 'æ–°ç«¹å¸‚' %}selected{% endif %}>æ–°ç«¹å¸‚</option>
  <option value="æ–°ç«¹ç¸£"  {% if prefill.destination == 'æ–°ç«¹ç¸£' %}selected{% endif %}>æ–°ç«¹ç¸£</option>
  <option value="è‹—æ —ç¸£"  {% if prefill.destination == 'è‹—æ —ç¸£' %}selected{% endif %}>è‹—æ —ç¸£</option>
  <option value="å°ä¸­å¸‚"  {% if prefill.destination == 'å°ä¸­å¸‚' %}selected{% endif %}>å°ä¸­å¸‚</option>
  <option value="å½°åŒ–ç¸£"  {% if prefill.destination == 'å½°åŒ–ç¸£' %}selected{% endif %}>å½°åŒ–ç¸£</option>
  <option value="å—æŠ•ç¸£"  {% if prefill.destination == 'å—æŠ•ç¸£' %}selected{% endif %}>å—æŠ•ç¸£</option>
  <option value="é›²æ—ç¸£"  {% if prefill.destination == 'é›²æ—ç¸£' %}selected{% endif %}>é›²æ—ç¸£</option>
  <option value="å˜‰ç¾©å¸‚"  {% if prefill.destination == 'å˜‰ç¾©å¸‚' %}selected{% endif %}>å˜‰ç¾©å¸‚</option>
  <option value="å˜‰ç¾©ç¸£"  {% if prefill.destination == 'å˜‰ç¾©ç¸£' %}selected{% endif %}>å˜‰ç¾©ç¸£</option>
  <option value="å°å—å¸‚"  {% if prefill.destination == 'å°å—å¸‚' %}selected{% endif %}>å°å—å¸‚</option>
  <option value="é«˜é›„å¸‚"  {% if prefill.destination == 'é«˜é›„å¸‚' %}selected{% endif %}>é«˜é›„å¸‚</option>
  <option value="å±æ±ç¸£"  {% if prefill.destination == 'å±æ±ç¸£' %}selected{% endif %}>å±æ±ç¸£</option>
  <option value="å®œè˜­ç¸£"  {% if prefill.destination == 'å®œè˜­ç¸£' %}selected{% endif %}>å®œè˜­ç¸£</option>
  <option value="èŠ±è“®ç¸£"  {% if prefill.destination == 'èŠ±è“®ç¸£' %}selected{% endif %}>èŠ±è“®ç¸£</option>
  <option value="å°æ±ç¸£"  {% if prefill.destination == 'å°æ±ç¸£' %}selected{% endif %}>å°æ±ç¸£</option>
  <option value="æ¾æ¹–ç¸£"  {% if prefill.destination == 'æ¾æ¹–ç¸£' %}selected{% endif %}>æ¾æ¹–ç¸£</option>
  <option value="é‡‘é–€ç¸£"  {% if prefill.destination == 'é‡‘é–€ç¸£' %}selected{% endif %}>é‡‘é–€ç¸£</option>
  <option value="é€£æ±Ÿç¸£"  {% if prefill.destination == 'é€£æ±Ÿç¸£' %}selected{% endif %}>é€£æ±Ÿç¸£</option>
</select>

<input type="text"
       id="customDestination"
       name="destination_custom"
       value="{{ prefill.destination_custom|default:'' }}"
       style="display:{% if prefill.destination == 'è‡ªå¡«' or prefill.destination_custom %}block{% else %}none{% endif %};"
       placeholder="è¼¸å…¥è‡ªè¨‚ç›®çš„åœ°" />


    <label for="driver-fare-note">é…Œæ”¶è²»ç”¨ï¼ˆé¸å¡«ï¼‰</label>
    <input type="text" id="driver-fare-note" name="fare_note"
           value="{{ prefill.fare_note|default:'' }}"
           placeholder="ä¾‹å¦‚ï¼šæ¯äºº 200ã€æ²¹éŒ¢å‡æ”¤ã€è¦–é‡Œç¨‹è€Œå®šâ€¦" />

    <label for="driver-date" class="required">å‡ºç™¼æ—¥æœŸ</label>
    <input type="date" name="date" id="driver-date" value="{{ prefill.date|default:'' }}" required />
  {% if error %}
    <div class="alert alert-danger">{{ error }}</div>
  {% endif %}
    <label for="driver-return">å›ç¨‹æ—¥æœŸï¼ˆé¸å¡«ï¼‰</label>
    <input type="date" name="return_date" id="driver-return" value="{{ prefill.return_date|default:'' }}" />

    <label for="note">å‚™è¨»</label>
    <textarea name="note" id="note">{{ prefill.note|default:'' }}</textarea>

    <button type="submit">âœ… é€å‡º</button>
  </form>

  <script>
    // å‡ºç™¼åœ°ç‚ºã€Œè‡ªå¡«ã€æ™‚é¡¯ç¤ºè‡ªè¨‚è¼¸å…¥æ¡†
    function checkCustomDeparture(select){
      const customInput = document.getElementById('customDeparture');
      if (!customInput) return;
      const show = (select.value === 'è‡ªå¡«');
      customInput.style.display = show ? 'block' : 'none';
      customInput.required = show;
      if (!show) customInput.value = '';
    }
    function checkCustomDestination(select){
    const input = document.getElementById('customDestination');
    if (!input) return;
    const show = (select.value === 'è‡ªå¡«');
    input.style.display = show ? 'block' : 'none';
    input.required = show;
    if (!show) input.value = '';
  }

    // å›ç¨‹æ—¥æœŸä¸å¯æ—©æ–¼å‡ºç™¼æ—¥æœŸï¼ˆå‰ç«¯å³æ™‚é˜²å‘†ï¼‰
    document.addEventListener('DOMContentLoaded', () => {
      const dep = document.getElementById('driver-date');
      const ret = document.getElementById('driver-return');
      if (!dep || !ret) return;

      function syncMin(){
        ret.min = dep.value || '';
        if (ret.value && dep.value && ret.value < dep.value) ret.value = '';
      }
      dep.addEventListener('change', syncMin);
      syncMin();
    });
    // é€²é åˆå§‹åŒ–ï¼ˆè‹¥é è¨­å°±é¸åˆ°è‡ªå¡«è¦å±•é–‹ï¼‰
  (function(){
    const depSel = document.getElementById('departure');
    const desSel = document.getElementById('destination');
    if (depSel) checkCustomDeparture(depSel);
    if (desSel) checkCustomDestination(desSel);
  })();
  </script>
</body>
</html>
